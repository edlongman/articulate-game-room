<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{margin:40px auto;padding:0 10px;max-width:650px;
  line-height:1.6;font-size:18px;font-family:sans-serif;color:#444}
h1,h2,h3{line-height:1.2}
.flex_cards{
  display:flexbox;
  display:flex;
  position: relative;
  flex-wrap: wrap;
}
.card{
  flex: 1;
  width: 50%;
  max-width: 200px;
  min-width: 150px;
  margin: 2px;
  border: 2px solid black;
  padding: 4px;
}</style>
<script src="/socket.io/socket.io.js"></script>
<h2>
Welcome to the articulate game room: <a href='/join'>Join</a>
</h2>
<div id="hand" class="flex_cards"></div>
<div id="feed"></div>
<script>
  var socket = io(document.location.origin);
  var feed_div = document.getElementById("feed");
  var hand_div = document.getElementById("hand");
  var name_res = window.prompt("What's your name", "");
  socket.emit('join', name_res);
  socket.on('feed', function (data) {
    console.log(data);
    var div = document.createElement('div');
    div.textContent = data.text;
    div.setAttribute('class', 'note');
    feed_div.appendChild(div);
  });

  var hand = [];
  socket.on('hand_deal', function(card){
    var div = document.createElement('div');
    if(card.src!==undefined){
      console.warn("Unimplemented picture card")
    }
    div.textContent = card.text;
    div.setAttribute('class', 'card');
    hand_div.appendChild(div);
    card.dom = div;
    hand.push(card);
  });
  socket.on('hand_retrieve', function(card){
    const removee_id = hand.map((item) => item.id).indexOf(card.id);
    if(removee_id<0){
      return false;
    }
    const removee = (hand.splice(removee_id, 1))[0];
    hand_div.removeChild(removee.dom);

  });
  socket.on('hand_flush', function(){
    console.warn("Unimplemented");
  });
</script>
